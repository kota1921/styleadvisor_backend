<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/tools/jwt_token_generator.py">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/tools/jwt_token_generator.py" />
              <option name="originalContent" value="import time&#10;import hmac&#10;import hashlib&#10;import json&#10;import base64&#10;from typing import Optional, Callable&#10;&#10;&#10;def _b64url(raw: bytes) -&gt; str:&#10;    return base64.urlsafe_b64encode(raw).decode('utf-8').rstrip('=')&#10;&#10;&#10;class JwtTokenGenerator:&#10;    &quot;&quot;&quot;Генератор JWT (HS256).&quot;&quot;&quot;&#10;    def __init__(self, now_provider: Optional[Callable[[], float]] = None):&#10;        self._now = now_provider or time.time&#10;&#10;    def generate(self, user_id: str, secret: str, ttl_seconds: int = 300) -&gt; str:&#10;        if not user_id:&#10;            raise ValueError(&quot;user_id пустой&quot;)&#10;        if not secret:&#10;            raise ValueError(&quot;secret пустой&quot;)&#10;        now = int(self._now())&#10;        header = {&quot;alg&quot;: &quot;HS256&quot;, &quot;typ&quot;: &quot;JWT&quot;}&#10;        payload = {&#10;            &quot;userId&quot;: user_id,&#10;            &quot;iat&quot;: now,&#10;            &quot;exp&quot;: now + int(ttl_seconds),&#10;        }&#10;        header_b64 = _b64url(json.dumps(header, separators=(',', ':')).encode('utf-8'))&#10;        payload_b64 = _b64url(json.dumps(payload, separators=(',', ':')).encode('utf-8'))&#10;        signing_input = f&quot;{header_b64}.{payload_b64}&quot;.encode('utf-8')&#10;        signature = hmac.new(secret.encode('utf-8'), signing_input, hashlib.sha256).digest()&#10;        sig_b64 = _b64url(signature)&#10;        return f&quot;{header_b64}.{payload_b64}.{sig_b64}&quot;&#10;" />
              <option name="updatedContent" value="import time&#10;import hmac&#10;import hashlib&#10;import json&#10;import base64&#10;from typing import Optional, Callable&#10;&#10;&#10;def _b64url(raw: bytes) -&gt; str:&#10;    return base64.urlsafe_b64encode(raw).decode('utf-8').rstrip('=')&#10;&#10;&#10;class JwtTokenGenerator:&#10;    &quot;&quot;&quot;Генератор JWT (HS256).&quot;&quot;&quot;&#10;    def __init__(self, now_provider: Optional[Callable[[], float]] = None):&#10;        self._now = now_provider or time.time&#10;&#10;    def generate(self, user_id: str, secret: str, ttl_seconds: int = 300) -&gt; str:&#10;        if not user_id:&#10;            raise ValueError(&quot;user_id пустой&quot;)&#10;        if not secret:&#10;            raise ValueError(&quot;secret пустой&quot;)&#10;        if int(ttl_seconds) &lt;= 0:&#10;            raise ValueError(&quot;ttl_seconds должен быть &gt; 0&quot;)&#10;        now = int(self._now())&#10;        header = {&quot;alg&quot;: &quot;HS256&quot;, &quot;typ&quot;: &quot;JWT&quot;}&#10;        payload = {&#10;            &quot;userId&quot;: user_id,&#10;            &quot;iat&quot;: now,&#10;            &quot;exp&quot;: now + int(ttl_seconds),&#10;        }&#10;        header_b64 = _b64url(json.dumps(header, separators=(',', ':')).encode('utf-8'))&#10;        payload_b64 = _b64url(json.dumps(payload, separators=(',', ':')).encode('utf-8'))&#10;        signing_input = f&quot;{header_b64}.{payload_b64}&quot;.encode('utf-8')&#10;        signature = hmac.new(secret.encode('utf-8'), signing_input, hashlib.sha256).digest()&#10;        sig_b64 = _b64url(signature)&#10;        return f&quot;{header_b64}.{payload_b64}.{sig_b64}&quot;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>